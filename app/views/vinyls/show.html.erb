<div class="container" style="margin-top: 10px; margin-bottom: 20px">

  <div class="vinyl">

    <div class= "vinyl-image">
      <%= cl_image_tag @vinyl.photo, height: 300, width: 300, crop: :fill %>
    <% if @vinyl.media_link %>
        <iframe src="https://open.spotify.com/embed/album/<%= @vinyl.media_link.chars.last(22).join %>" frameborder="0" allowtransparency="true" height="80" allow="encrypted-media" style="margin-top:10px;"></iframe>
      <% end %>
    </div>

    <div class="vinyl-description">


      <h1><%= @vinyl.name %></h1>
      <h2><%= @vinyl.artist %></h2>
      <p><%= @vinyl.media_link %></p>

      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr;  grid-gap: 8px; line-height: 1em; padding-bottom: 5px; ">
        <div style="border-left: 1px solid grey; padding-left: 8px; justify-content:center; ">
          <p style="color: light-grey;"><strong>Year</strong></p>
          <p><%= @vinyl.year %></p>
        </div>
        <div style="border-left: 1px solid grey; padding-left: 8px;">
          <p style="color: light-grey;"><strong>Genre</strong></p>
          <p><%= @vinyl.genre %></p>
        </div>
        <div style="border-left: 1px solid grey; padding-left: 8px;">
          <p style="color: light-grey;"><strong>Condition</strong></p>
          <p><%= @vinyl.condition %></p>
        </div>

      </div>

      <p><%= @vinyl.description %></p>

      <% if policy(@vinyl).edit? %>
        <%= link_to "Update", edit_vinyl_path(@vinyl), class: 'btn btn-primary'%>
        <%= link_to "Delete", vinyl_path(@vinyl), method: :delete, class: 'btn btn-primary' %>
      <% end %>
      <% if policy(Vinyl).new? %>
        <%= link_to 'Add a vinyl', new_vinyl_path, class: 'btn btn-success' %>
      <% end %>
    </div>

    <div class="profile-box">
      <div>
        <h2 style="color: #FA2B57"><strong>£<%= @vinyl.price %></strong></h2>

        <%= link_to "buy now", order_vinyl_path(@vinyl), class: 'btn btn-danger'%>
      </div>
      <div>
        <hr>
      </div>
      <div>
        <%= link_to user_path(@vinyl.seller) do %>
        <p><%= cl_image_tag @vinyl.seller.photo, class: "avatar-user-page"%></p>
        <h3><%= @vinyl.seller.first_name %></h3>
        <% end %>

        <div style="color: #FA2B57">
          <% average_rating = 0 %>
          <% @vinyl.seller.reviews.each do |review| %>
            <% average_rating += review.rating %>
          <% end %>
          <% final = average_rating / @vinyl.seller.reviews.count %>
          <div style="color: #FA2B57">
            <% final.times do %>
              <i class="fas fa-star"></i>
            <% end %>
          </div>
          <p><%= @vinyl.seller.reviews.count %> user reviews</p>
          <p>Selling since 2019</p>
        </div>
      </div>
    </div>
  </div>

   <br>
  <h3>Other items for sale by <%= @vinyl.seller.first_name %> </h3>
  <br>

  <div class="cards">
      <% @user_vinyls.each do |vinyl| %>
        <%= link_to vinyl_path(vinyl) do %>
          <div class="card-full">
            <div class="card-full-infos">
              <div>
                <h2><%= vinyl.name %></h2>
                <p><%= vinyl.artist %></p>
              </div>
              <h2 class="card-full-pricing">£ <%= '%.2f' % vinyl.price %></h2>
            </div>
              <%= cl_image_tag vinyl.photo %>
          </div>
        <% end %>
      <% end %>
    </div>

</div>
